# Implementation

## Overview

The program implements a simple version of the [RSA cryptosystem](https://en.wikipedia.org/wiki/RSA_(cryptosystem)) in Python. The application has a command-line interface. It offers functionality for generating (both public and private) keys and using them to encrypt and decrypt messages.

[Poetry](https://python-poetry.org/) is used for managing dependencies and the commands for various *tasks* are handled by [Invoke](https://www.pyinvoke.org/).

## Data structures and algorithms

Multiple different algorithms are implemented. Together they form a working program.

### Key generation

The following algorithm is used to generate the public and the private key.

1. Choose a desired *key length*.
    - Should be a power of two, usually $2^{10} = 1024$, $2^{11} = 2048$ or $2^{12} = 4096$.
    - Greater key length permits longer messages and offers stronger encryption but key generation will take longer.
2. Choose two *distinct* prime numbers, $p$ and $q$.
    - These values are to be kept secret and disposed of after key generation.
    - The *bit length* of each should be half the key length chosen in step 1.
    - Large prime numbers can be found efficiently using the *Miller-Rabin* test.
3. Calculate $n = pq$.
    - $n$ is the *modulus*, used for both keys. It will be made public.
    - The bit length of $n$ should match the key length chosen in step 1.
4. Calculate $\phi(n) = (p-1)(q-1)$.
    - The value will be kept secret and forgotten after key generation.
5. Choose an integer $e$, so that $e$ and $\phi$ are *coprime* and $1 < e < \phi$.
    - Usually $2^{16} = 65537$ is a good choice and my implementation also uses this value.
6. Calculate $d$.
    - $d$ can be calculated using the *extended Euclidean algorithm*.
    - $d$ is the exponent part of the *secret key* and should **not** be published anywhere.

To summarize:
- The public key is made of the modulus $n$ and the *encryption exponent* $e$.
- The private key consists of $n$ and the *decryption exponent* $d$.

#### Primality test

To be written.

#### Encryption

To be written.

#### Decryption

To be written.

## Time and space complexities

To be written.

## Testing

See the [testing document](testing.md) for more details.

## Project structure

The project has the following file structure. All documentation can be found in the `documentation` directory. The contents of `htmlcov` are generated by the *coverage* command. The only relevant file there is *index.html* and it should be opened in a web browser to inspect the test coverage. The directory `src` contains the source code of the program, including automated tests. The file *index.py* is the entry point and the file *app.py* contains the main application loop logic and user interface code.

As the project is managed by Poetry, the directory contains the configuration files *poetry.lock* and *pyproject.toml*. They are needed to install dependencies. See the user manual for instructions. The file *tasks.py* is used by the dependency Invoke, which is used to define commands for Poetry. And as expected, *README.md* contains relevant information about the repository and is displayed on the project's GitHub page.

```
├── documentation
│   ├── guide.md
│   ├── images
│   │   └── coverage-report.png
│   ├── implementation.md
│   ├── reports
│   │   ├── week1.md
│   │   ├── ...
│   │   └── week6.md
│   ├── specification.md
│   └── testing.md
├── htmlcov
│   ├── ...
│   ├── index.html
│   ├── ...
├── poetry.lock
├── pyproject.toml
├── README.md
├── src
│   ├── app.py
│   ├── console_io.py
│   ├── functions
│   │   ├── crypt.py
│   │   ├── __init__.py
│   │   ├── keygen.py
│   ├── index.py
│   └── tests
│       ├── functions
│       │   ├── crypt_test.py
│       │   ├── __init__.py
│       │   ├── keygen_test.py
│       ├── __init__.py
├── .coverage
├── .coveragerc
├── .gitignore
├── .pylintrc
├── .python-version
├── tasks.py

```

## Sources

The following sources have been used in the development process.

- [ASCII Code](https://www.ascii-code.com/) (n.d.) | ascii-code.com
- [Coprime integers](https://en.wikipedia.org/wiki/Coprime_integers) (n.d.) | wikipedia.org
- [Euclidean algorithm](https://en.wikipedia.org/wiki/Euclidean_algorithm) (n.d.) | wikipedia.org
- [Euclidean division](https://en.wikipedia.org/wiki/Euclidean_division) (n.d.) | wikipedia.org
- [Extended Euclidean algorithm](https://brilliant.org/wiki/extended-euclidean-algorithm/) (n.d.) | brilliant.org
- [Extended Euclidean algorithm](https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm) (n.d.) | wikipedia.org
- [Miller–Rabin primality test](https://rosettacode.org/wiki/Miller%E2%80%93Rabin_primality_test) (n.d.) | rosettacode.org
- [Miller-Rabin primality test](https://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test) (n.d.) | wikipedia.org
- [Public Key Cryptography: RSA Encryption Algorithm](https://www.youtube.com/watch?v=wXB-V_Keiu8) (2012) | Art of the Problem on youtube.com
- [RSA (cryptosystem)](https://en.wikipedia.org/wiki/RSA_(cryptosystem)) (n.d.) | wikipedia.org
- [RSA - bitlength of p and q](https://stackoverflow.com/questions/12192116/rsa-bitlength-of-p-and-q/12195783#12195783) (2012) | Mark Dickinson on stackoverflow.com
- [RSA Encryption](https://brilliant.org/wiki/rsa-encryption/) (n.d.) | brilliant.org
